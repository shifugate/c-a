<!DOCTYPE html>
<html>
	<script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>

	<style>
	  .arjs-loader {
		height: 100%;
		width: 100%;
		position: absolute;
		top: 0;
		left: 0;
		background-color: rgba(0, 0, 0, 0.8);
		z-index: 9999;
		display: flex;
		justify-content: center;
		align-items: center;
	  }

	  .arjs-loader div {
		text-align: center;
		font-size: 1.25em;
		color: white;
	  }
	</style>

	<!-- rawgithack development URL -->
	<script src='https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js'></script>

	<body style='margin : 0px; overflow: hidden;'>
	   <!-- minimal loader shown until image descriptors are loaded -->
	  <div class="arjs-loader">
		<div>Loading, please wait...</div>
	  </div>
		<a-scene
			vr-mode-ui="enabled: false;"
			renderer="logarithmicDepthBuffer: true;"
			embedded arjs='trackingMethod: best; sourceType: webcam; debugUIEnabled: false;'>
			<a-assets>
				<video id="ca-video" preload="auto" loop="true" src="https://arjs-cors-proxy.herokuapp.com/https://shifugate.github.io/c-a/video.mp4" response-type="arraybuffer"></video>
			</a-assets>

			<a-nft
				type='nft' url='https://arjs-cors-proxy.herokuapp.com/https://shifugate.github.io/c-a/assets/camarker'
				smooth='true' smoothCount='10' smoothTolerance='0.01' smoothThreshold='5' vidhandler>
				<a-video src="#ca-video" width="512" height="288" position="0 0 -100"></a-video>
			</a-nft>
			<a-entity camera></a-entity>
		</a-scene>
	</body>
	<script>
		AFRAME.registerComponent('vidhandler', {
			init: function () {
				var marker = this.el;
				
				this.vid = document.querySelector('#ca-video');
				
				marker.addEventListener(
					"markerFound",
					function () {
						this.vid.play();
					}.bind(this)
				);
				
				marker.addEventListener(
					"markerLost",
					function () {
						this.vid.pause();
						this.vid.currTime = 0;
					}.bind(this)
				);
			}
		});
	</script>
</html>